{"explainVersion": "2", "queryPlanner": {"namespace": "cbd.restaurants", "indexFilterSet": false, "parsedQuery": {"gastronomia": {"$eq": "Bakery"}}, "queryHash": "638EA66C", "planCacheKey": "F8681F96", "maxIndexedOrSolutionsReached": false, "maxIndexedAndSolutionsReached": false, "maxScansToExplodeReached": false, "winningPlan": {"queryPlan": {"stage": "FETCH", "planNodeId": 2, "inputStage": {"stage": "IXSCAN", "planNodeId": 1, "keyPattern": {"gastronomia": 1}, "indexName": "gastronomia_1", "isMultiKey": false, "multiKeyPaths": {"gastronomia": []}, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "forward", "indexBounds": {"gastronomia": ["[\"Bakery\", \"Bakery\"]"]}}}, "slotBasedPlan": {"slots": "$$RESULT=s11 env: { s2 = Nothing (SEARCH_META), s10 = {\"gastronomia\" : 1}, s1 = TimeZoneDatabase(America/Monterrey...US/Hawaii) (timeZoneDB), s6 = KS(3C42616B65727900FE04), s3 = 1697032555916 (NOW), s5 = KS(3C42616B657279000104) }", "stages": "[2] nlj inner [] [s4, s7, s8, s9, s10] \n    left \n        [1] cfilter {(exists(s5) && exists(s6))} \n        [1] ixseek s5 s6 s9 s4 s7 s8 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"gastronomia_1\" true \n    right \n        [2] limit 1 \n        [2] seek s4 s11 s12 s7 s8 s9 s10 [] @\"41887e16-033b-448b-96f0-367493830ca0\" true false \n"}}, "rejectedPlans": []}, "executionStats": {"executionSuccess": true, "nReturned": 127, "executionTimeMillis": 0, "totalKeysExamined": 127, "totalDocsExamined": 127, "executionStages": {"stage": "nlj", "planNodeId": 2, "nReturned": 127, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "totalDocsExamined": 127, "totalKeysExamined": 127, "collectionScans": 0, "collectionSeeks": 127, "indexScans": 0, "indexSeeks": 1, "indexesUsed": ["gastronomia_1"], "innerOpens": 127, "innerCloses": 1, "outerProjects": [], "outerCorrelated": [4, 7, 8, 9, 10], "outerStage": {"stage": "cfilter", "planNodeId": 1, "nReturned": 127, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "numTested": 1, "filter": "(exists(s5) && exists(s6)) ", "inputStage": {"stage": "ixseek", "planNodeId": 1, "nReturned": 127, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "gastronomia_1", "keysExamined": 127, "seeks": 1, "numReads": 128, "indexKeySlot": 9, "recordIdSlot": 4, "snapshotIdSlot": 7, "indexIdentSlot": 8, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "s5 ", "seekKeyHigh": "s6 "}}, "innerStage": {"stage": "limit", "planNodeId": 2, "nReturned": 127, "executionTimeMillisEstimate": 0, "opens": 127, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "limit": 1, "inputStage": {"stage": "seek", "planNodeId": 2, "nReturned": 127, "executionTimeMillisEstimate": 0, "opens": 127, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 0, "numReads": 127, "recordSlot": 11, "recordIdSlot": 12, "seekKeySlot": 4, "snapshotIdSlot": 7, "indexIdentSlot": 8, "indexKeySlot": 9, "indexKeyPatternSlot": 10, "fields": [], "outputSlots": []}}}, "allPlansExecution": []}, "command": {"find": "restaurants", "filter": {"gastronomia": "Bakery"}, "$db": "cbd"}, "serverInfo": {"host": "diana-Legion-5-Pro-16ACH6", "port": 27017, "version": "7.0.2", "gitVersion": "02b3c655e1302209ef046da6ba3ef6749dd0b62a"}, "serverParameters": {"internalQueryFacetBufferSizeBytes": 104857600, "internalQueryFacetMaxOutputDocSizeBytes": 104857600, "internalLookupStageIntermediateDocumentMaxSizeBytes": 104857600, "internalDocumentSourceGroupMaxMemoryBytes": 104857600, "internalQueryMaxBlockingSortMemoryUsageBytes": 104857600, "internalQueryProhibitBlockingMergeOnMongoS": 0, "internalQueryMaxAddToSetBytes": 104857600, "internalDocumentSourceSetWindowFieldsMaxMemoryBytes": 104857600, "internalQueryFrameworkControl": "trySbeEngine"}, "ok": 1.0}


{"explainVersion": "2", "queryPlanner": {"namespace": "cbd.restaurants", "indexFilterSet": false, "parsedQuery": {"localidade": {"$eq": "Bronx"}}, "queryHash": "A0929D09", "planCacheKey": "C631E997", "maxIndexedOrSolutionsReached": false, "maxIndexedAndSolutionsReached": false, "maxScansToExplodeReached": false, "winningPlan": {"queryPlan": {"stage": "FETCH", "planNodeId": 2, "inputStage": {"stage": "IXSCAN", "planNodeId": 1, "keyPattern": {"localidade": 1}, "indexName": "localidade_1", "isMultiKey": false, "multiKeyPaths": {"localidade": []}, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "forward", "indexBounds": {"localidade": ["[\"Bronx\", \"Bronx\"]"]}}}, "slotBasedPlan": {"slots": "$$RESULT=s11 env: { s1 = TimeZoneDatabase(America/Monterrey...US/Hawaii) (timeZoneDB), s3 = 1697032555846 (NOW), s2 = Nothing (SEARCH_META), s5 = KS(3C42726F6E78000104), s10 = {\"localidade\" : 1}, s6 = KS(3C42726F6E7800FE04) }", "stages": "[2] nlj inner [] [s4, s7, s8, s9, s10] \n    left \n        [1] cfilter {(exists(s5) && exists(s6))} \n        [1] ixseek s5 s6 s9 s4 s7 s8 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"localidade_1\" true \n    right \n        [2] limit 1 \n        [2] seek s4 s11 s12 s7 s8 s9 s10 [] @\"41887e16-033b-448b-96f0-367493830ca0\" true false \n"}}, "rejectedPlans": []}, "executionStats": {"executionSuccess": true, "nReturned": 309, "executionTimeMillis": 0, "totalKeysExamined": 309, "totalDocsExamined": 309, "executionStages": {"stage": "nlj", "planNodeId": 2, "nReturned": 309, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "totalDocsExamined": 309, "totalKeysExamined": 309, "collectionScans": 0, "collectionSeeks": 309, "indexScans": 0, "indexSeeks": 1, "indexesUsed": ["localidade_1"], "innerOpens": 309, "innerCloses": 1, "outerProjects": [], "outerCorrelated": [4, 7, 8, 9, 10], "outerStage": {"stage": "cfilter", "planNodeId": 1, "nReturned": 309, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "numTested": 1, "filter": "(exists(s5) && exists(s6)) ", "inputStage": {"stage": "ixseek", "planNodeId": 1, "nReturned": 309, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "localidade_1", "keysExamined": 309, "seeks": 1, "numReads": 310, "indexKeySlot": 9, "recordIdSlot": 4, "snapshotIdSlot": 7, "indexIdentSlot": 8, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "s5 ", "seekKeyHigh": "s6 "}}, "innerStage": {"stage": "limit", "planNodeId": 2, "nReturned": 309, "executionTimeMillisEstimate": 0, "opens": 309, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "limit": 1, "inputStage": {"stage": "seek", "planNodeId": 2, "nReturned": 309, "executionTimeMillisEstimate": 0, "opens": 309, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 0, "numReads": 309, "recordSlot": 11, "recordIdSlot": 12, "seekKeySlot": 4, "snapshotIdSlot": 7, "indexIdentSlot": 8, "indexKeySlot": 9, "indexKeyPatternSlot": 10, "fields": [], "outputSlots": []}}}, "allPlansExecution": []}, "command": {"find": "restaurants", "filter": {"localidade": "Bronx"}, "$db": "cbd"}, "serverInfo": {"host": "diana-Legion-5-Pro-16ACH6", "port": 27017, "version": "7.0.2", "gitVersion": "02b3c655e1302209ef046da6ba3ef6749dd0b62a"}, "serverParameters": {"internalQueryFacetBufferSizeBytes": 104857600, "internalQueryFacetMaxOutputDocSizeBytes": 104857600, "internalLookupStageIntermediateDocumentMaxSizeBytes": 104857600, "internalDocumentSourceGroupMaxMemoryBytes": 104857600, "internalQueryMaxBlockingSortMemoryUsageBytes": 104857600, "internalQueryProhibitBlockingMergeOnMongoS": 0, "internalQueryMaxAddToSetBytes": 104857600, "internalDocumentSourceSetWindowFieldsMaxMemoryBytes": 104857600, "internalQueryFrameworkControl": "trySbeEngine"}, "ok": 1.0}

{"explainVersion": "2", "queryPlanner": {"namespace": "cbd.restaurants", "indexFilterSet": false, "parsedQuery": {"$text": {"$search": "\"Morris Park Bake Shop\"", "$language": "english", "$caseSensitive": false, "$diacriticSensitive": false}}, "queryHash": "A3F93F23", "planCacheKey": "5C769D84", "maxIndexedOrSolutionsReached": false, "maxIndexedAndSolutionsReached": false, "maxScansToExplodeReached": false, "winningPlan": {"queryPlan": {"stage": "TEXT_MATCH", "planNodeId": 7, "indexPrefix": {}, "indexName": "nome_text", "parsedTextQuery": {"terms": ["bake", "morri", "park", "shop"], "negatedTerms": [], "phrases": ["Morris Park Bake Shop"], "negatedPhrases": []}, "textIndexVersion": 2, "inputStage": {"stage": "FETCH", "planNodeId": 6, "inputStage": {"stage": "OR", "planNodeId": 5, "inputStages": [{"stage": "IXSCAN", "planNodeId": 1, "keyPattern": {"_fts": "text", "_ftsx": 1}, "indexName": "nome_text", "isMultiKey": true, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "backward", "indexBounds": {}}, {"stage": "IXSCAN", "planNodeId": 2, "keyPattern": {"_fts": "text", "_ftsx": 1}, "indexName": "nome_text", "isMultiKey": true, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "backward", "indexBounds": {}}, {"stage": "IXSCAN", "planNodeId": 3, "keyPattern": {"_fts": "text", "_ftsx": 1}, "indexName": "nome_text", "isMultiKey": true, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "backward", "indexBounds": {}}, {"stage": "IXSCAN", "planNodeId": 4, "keyPattern": {"_fts": "text", "_ftsx": 1}, "indexName": "nome_text", "isMultiKey": true, "isUnique": false, "isSparse": false, "isPartial": false, "indexVersion": 2, "direction": "backward", "indexBounds": {}}]}}}, "slotBasedPlan": {"slots": "$$RESULT=s26 env: { s2 = Nothing (SEARCH_META), s1 = TimeZoneDatabase(America/Monterrey...US/Hawaii) (timeZoneDB), s3 = 1697032555935 (NOW), s8 = {\"_fts\" : \"text\", \"_ftsx\" : 1} }", "stages": "[7] filter {\n    if isObject(s26) \n    then ftsMatch(FtsMatcher({\"terms\" : [\"bake\", \"morri\", \"park\", \"shop\"], \"negatedTerms\" : [], \"phrases\" : [\"Morris Park Bake Shop\"], \"negatedPhrases\" : []}), s26) \n    else fail(4623400, \"textmatch requires input to be an object\") \n} \n[6] nlj inner [] [s23, s21, s22, s24, s25] \n    left \n        [5] unique [s23] \n        [5] union [s22, s24, s25, s23, s21] \n            branch0 [s6, s7, s8, s4, s5] \n                [1] unique [s4] \n                [1] ixseek KS(3C62616B65002E77359400FE04) KS(3C62616B6500290104) s7 s4 s5 s6 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"nome_text\" false \n            branch1 [s11, s12, s8, s9, s10] \n                [2] unique [s9] \n                [2] ixseek KS(3C6D6F727269002E77359400FE04) KS(3C6D6F72726900290104) s12 s9 s10 s11 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"nome_text\" false \n            branch2 [s15, s16, s8, s13, s14] \n                [3] unique [s13] \n                [3] ixseek KS(3C7061726B002E77359400FE04) KS(3C7061726B00290104) s16 s13 s14 s15 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"nome_text\" false \n            branch3 [s19, s20, s8, s17, s18] \n                [4] unique [s17] \n                [4] ixseek KS(3C73686F70002E77359400FE04) KS(3C73686F7000290104) s20 s17 s18 s19 [] @\"41887e16-033b-448b-96f0-367493830ca0\" @\"nome_text\" false \n    right \n        [6] limit 1 \n        [6] seek s23 s26 s27 s21 s22 s24 s25 [] @\"41887e16-033b-448b-96f0-367493830ca0\" true false \n"}}, "rejectedPlans": []}, "executionStats": {"executionSuccess": true, "nReturned": 1, "executionTimeMillis": 0, "totalKeysExamined": 104, "totalDocsExamined": 96, "executionStages": {"stage": "filter", "planNodeId": 7, "nReturned": 1, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "numTested": 96, "filter": "\n    if isObject(s26) \n    then ftsMatch(FtsMatcher({\"terms\" : [\"bake\", \"morri\", \"park\", \"shop\"], \"negatedTerms\" : [], \"phrases\" : [\"Morris Park Bake Shop\"], \"negatedPhrases\" : []}), s26) \n    else fail(4623400, \"textmatch requires input to be an object\") \n", "inputStage": {"stage": "nlj", "planNodeId": 6, "nReturned": 96, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "totalDocsExamined": 96, "totalKeysExamined": 104, "collectionScans": 0, "collectionSeeks": 96, "indexScans": 0, "indexSeeks": 4, "indexesUsed": ["nome_text", "nome_text", "nome_text", "nome_text"], "innerOpens": 96, "innerCloses": 1, "outerProjects": [], "outerCorrelated": [23, 21, 22, 24, 25], "outerStage": {"stage": "unique", "planNodeId": 5, "nReturned": 96, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "dupsTested": 104, "dupsDropped": 8, "keySlots": [23], "inputStage": {"stage": "union", "planNodeId": 5, "nReturned": 104, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "inputSlots": [6, 7, 8, 4, 5, 11, 12, 8, 9, 10, 15, 16, 8, 13, 14, 19, 20, 8, 17, 18], "outputSlots": [22, 24, 25, 23, 21], "inputStages": [{"stage": "unique", "planNodeId": 1, "nReturned": 9, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "dupsTested": 9, "dupsDropped": 0, "keySlots": [4], "inputStage": {"stage": "ixseek", "planNodeId": 1, "nReturned": 9, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "nome_text", "keysExamined": 9, "seeks": 1, "numReads": 10, "indexKeySlot": 7, "recordIdSlot": 4, "snapshotIdSlot": 5, "indexIdentSlot": 6, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "KS(3C62616B65002E77359400FE04) ", "seekKeyHigh": "KS(3C62616B6500290104) "}}, {"stage": "unique", "planNodeId": 2, "nReturned": 2, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "dupsTested": 2, "dupsDropped": 0, "keySlots": [9], "inputStage": {"stage": "ixseek", "planNodeId": 2, "nReturned": 2, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "nome_text", "keysExamined": 2, "seeks": 1, "numReads": 3, "indexKeySlot": 12, "recordIdSlot": 9, "snapshotIdSlot": 10, "indexIdentSlot": 11, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "KS(3C6D6F727269002E77359400FE04) ", "seekKeyHigh": "KS(3C6D6F72726900290104) "}}, {"stage": "unique", "planNodeId": 3, "nReturned": 23, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "dupsTested": 23, "dupsDropped": 0, "keySlots": [13], "inputStage": {"stage": "ixseek", "planNodeId": 3, "nReturned": 23, "executionTimeMillisEstimate": 0, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "nome_text", "keysExamined": 23, "seeks": 1, "numReads": 24, "indexKeySlot": 16, "recordIdSlot": 13, "snapshotIdSlot": 14, "indexIdentSlot": 15, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "KS(3C7061726B002E77359400FE04) ", "seekKeyHigh": "KS(3C7061726B00290104) "}}, {"stage": "unique", "planNodeId": 4, "nReturned": 70, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "dupsTested": 70, "dupsDropped": 0, "keySlots": [17], "inputStage": {"stage": "ixseek", "planNodeId": 4, "nReturned": 70, "executionTimeMillisEstimate": 1, "opens": 1, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "indexName": "nome_text", "keysExamined": 70, "seeks": 1, "numReads": 71, "indexKeySlot": 20, "recordIdSlot": 17, "snapshotIdSlot": 18, "indexIdentSlot": 19, "outputSlots": [], "indexKeysToInclude": "00000000000000000000000000000000", "seekKeyLow": "KS(3C73686F70002E77359400FE04) ", "seekKeyHigh": "KS(3C73686F7000290104) "}}]}}, "innerStage": {"stage": "limit", "planNodeId": 6, "nReturned": 96, "executionTimeMillisEstimate": 0, "opens": 96, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 1, "limit": 1, "inputStage": {"stage": "seek", "planNodeId": 6, "nReturned": 96, "executionTimeMillisEstimate": 0, "opens": 96, "closes": 1, "saveState": 0, "restoreState": 0, "isEOF": 0, "numReads": 96, "recordSlot": 26, "recordIdSlot": 27, "seekKeySlot": 23, "snapshotIdSlot": 21, "indexIdentSlot": 22, "indexKeySlot": 24, "indexKeyPatternSlot": 25, "fields": [], "outputSlots": []}}}}, "allPlansExecution": []}, "command": {"find": "restaurants", "filter": {"$text": {"$search": "\"Morris Park Bake Shop\""}}, "$db": "cbd"}, "serverInfo": {"host": "diana-Legion-5-Pro-16ACH6", "port": 27017, "version": "7.0.2", "gitVersion": "02b3c655e1302209ef046da6ba3ef6749dd0b62a"}, "serverParameters": {"internalQueryFacetBufferSizeBytes": 104857600, "internalQueryFacetMaxOutputDocSizeBytes": 104857600, "internalLookupStageIntermediateDocumentMaxSizeBytes": 104857600, "internalDocumentSourceGroupMaxMemoryBytes": 104857600, "internalQueryMaxBlockingSortMemoryUsageBytes": 104857600, "internalQueryProhibitBlockingMergeOnMongoS": 0, "internalQueryMaxAddToSetBytes": 104857600, "internalDocumentSourceSetWindowFieldsMaxMemoryBytes": 104857600, "internalQueryFrameworkControl": "trySbeEngine"}, "ok": 1.0}

